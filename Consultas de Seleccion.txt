HRS_RCM_SCR_VW -- Preselecci√≥n


SELECT A.HRS_PERSON_ID 
 ,A.HRS_RCMNT_ID 
 ,A.HRS_PROFILE_SEQ 
 ,A.HRS_JOB_OPENING_ID 
 ,A.STATUS_CODE 
 ,A.STATUS_REASON 
 ,A.HRS_STATUS_DT 
 ,A.ENTRY_SOURCE 
 ,A.ENTRY_DATE 
 ,A.CONTRACT_NUM 
 ,A.ESTABID 
 ,A.OFF_REFSRC_CAT 
 ,A.OFF_REFSRC_SUB 
 ,A.REQST_ADDTNL_INFO 
 ,A.KEYWORD_MATCH 
  FROM PS_HRS_RCMNT A 
 WHERE A.HRS_RCMNT_ID = ( 
 SELECT MAX(D.HRS_RCMNT_ID) 
  FROM PS_HRS_RCMNT D 
 WHERE D.HRS_PERSON_ID = A.HRS_PERSON_ID 
   AND D.HRS_JOB_OPENING_ID = A.HRS_JOB_OPENING_ID 
   AND D.STATUS_CODE NOT IN ( 
 SELECT STATUS_CODE 
  FROM PS_HRS_STS_REC_I 
 WHERE STATUS_AREA = '3' 
   AND HRS_DRFT_STS_IND = 'Y'));
   
   SELECT * FROM PS_HRS_STS_REC_I;
   
   
   SELECT A.HRS_JOB_OPENING_ID
,A.STATUS_CODE
,A.HRS_PERSON_ID
,A.HRS_RCMNT_ID
,A.HRS_PROFILE_SEQ
,A.HRS_APP_INTEREST
,A.ENTRY_DATE
,A.STATUS_REASON
,B.DESCRSHORT
,B.DESCR
,A.HRS_STATUS_DT
,B.STATUS_PHASE
,NM.LAST_NAME
,APP.APP_PER_STATUS
,A.HRS_ROW_UPD_DTTM
,PROF.PREV_EMPL_BY_COMPY
,PROF.HRS_RESUME_ID
FROM PS_HRS_RCMNT A
, PS_HRS_APPLICANT APP
, PS_HRS_APP_PROFILE PROF
, PS_HRS_STS_TBL B
, PS_HRS_APP_NAMES NM
WHERE APP.HRS_PERSON_ID = A.HRS_PERSON_ID
AND PROF.HRS_PERSON_ID = A.HRS_PERSON_ID
AND PROF.HRS_PROFILE_SEQ = A.HRS_PROFILE_SEQ
AND B.STATUS_CODE = A.STATUS_CODE
AND NM.HRS_PERSON_ID = A.HRS_PERSON_ID
AND B.STATUS_AREA = '3'
AND B.HRS_DRFT_STS_IND IN ('N', ' ')
AND NM.NAME_TYPE = 'PRI'